# TODO

## 待修复
1.考虑加大移动端 主内容区/侧栏/搜索渲染 的字体大小与间隔大小

## 建议
1. 是否要结合UA判断来做响应式处理
2. 搜索结果筛选：文件夹名/书签名/URL
3. 考虑是否重新使用oobe这样的加载库
4. 多根目录时考虑展开得到一级文件夹

## 性能优化list

### 1. 数据加载优化
- [ ] **缓存策略优化**：当前使用localStorage缓存，但没有设置过期时间，可能导致数据陈旧。建议添加缓存过期机制。
- [ ] ~~**增量加载**：对于大型bookmarks.json（目前约500KB+，无性能问题），可以考虑分块加载或虚拟滚动技术。~~
- [ ] **数据预处理优化**：在data-worker.js中，可以对数据进行预处理以加快搜索速度，如建立索引。

### 2. 搜索功能优化
- [x] **搜索缓存优化**：search-worker.js中的Map缓存没有大小限制，可能导致内存泄漏。建议实现LRU缓存机制。
- [ ] **搜索算法优化**：当前使用简单的字符串包含匹配，可以考虑实现更高效的搜索算法如模糊搜索或全文搜索。
- [ ] **搜索防抖优化**：当前防抖时间为250ms，可以进一步调整以平衡响应速度和性能。

### 3. DOM操作优化
- [ ] **内容渲染优化**：content.js中使用createDocumentFragment，但可以进一步优化，如实现虚拟滚动来处理大量书签。
- [ ] **事件监听器优化**：确保所有事件监听器在重新渲染时正确移除，避免内存泄漏。
- [ ] **DOM查询优化**：多次查询相同元素，可以缓存查询结果。

### 4. 分页系统优化
- [ ] **分页渲染优化**：pagination/renderer.js中实现了元素池，但可以进一步优化DOM操作，减少重排重绘。
- [ ] **分页状态管理**：考虑使用更高效的状态管理方式，减少不必要的重新计算。
- [ ] **分页内存优化**：定期清理分页相关的内存使用，特别是elementPool。

### 5. Web Worker优化
- [ ] **Worker复用**：当前每次搜索都创建新的Worker然后终止，可以考虑复用Worker实例。
- [ ] **Worker通信优化**：大量数据传输可能成为瓶颈，考虑只传输必要数据。

### 6. CSS/动画优化
- [ ] **CSS变量计算优化**：animation.css中使用了大量CSS变量，可以检查是否所有变量都是必要的。
- [ ] **选择器优化**：检查CSS选择器的复杂度，避免使用过于复杂的选择器。
- [ ] **重绘优化**：检查哪些元素会触发重绘和重排，尽量使用transform和opacity等不会触发重排的属性。

### 7. 响应式系统优化
- [ ] **媒体查询优化**：responsive.js中频繁监听resize事件，可以使用requestAnimationFrame或防抖优化。
- [ ] **设备检测优化**：设备类型检测可以缓存结果，避免重复计算。

### 8. 内存管理优化
- [ ] **内存泄漏检查**：定期清理事件监听器、定时器、WeakMap等引用。
- [ ] **垃圾回收优化**：确保及时解除不需要的引用，帮助浏览器进行垃圾回收。

### 9. 网络请求优化
- [x] **资源预加载**：index.html中已有一些预加载，但可以进一步优化关键资源的加载优先级。
- [ ] **HTTP缓存策略**：为静态资源设置合适的缓存头。

### 10. 存储优化
- [ ] ~~**localStorage使用优化**：localStorage是同步阻塞操作，大量数据读写可能影响性能，可以考虑使用IndexedDB。~~（暂时不需要，徒增复杂度）
- [ ] **存储数据结构优化**：考虑使用更高效的数据结构存储书签数据。

### 11. JavaScript执行优化
- [ ] **代码分割**：考虑将不常用的代码进行懒加载。
- [ ] **模块加载优化**：检查模块依赖关系，避免循环依赖。
- [ ] **函数执行优化**：使用requestIdleCallback处理非关键任务。

## 已修复的问题

- [x] 模块化了CSS

- [x] 解决了CSP警告

- [x] 解决字体模糊问题

- [x] 修复gif背景缩放位置问题

- [x] 合并DOM监听器

- [x] 拆分函数为单一职责

- [x] 修复移动端点击后样式丢失问题

- [x] 统一断点系统重构

- [x] 模块化了Render相关js

- [x] 修复若干响应式bug

- [x] 修复多个渲染问题

- [x] 搜索结果分页

- [x] 分页控件响应式设计

- [x] 移动端分页优化

- [x] 分页控件样式统一

- [x] 分页性能优化

- [x] 分页无障碍支持

- [x] 分页滚动行为优化

- [x] 无结果提示的清理